import{a as C}from"./chunk-ECJDY5WB.js";import{a as ve,b as Ce,c as ye,d as Fe,e as xe,f as _e}from"./chunk-7ZQZXC37.js";import{i as te}from"./chunk-4FAUQBSB.js";import{a as oe,b as S,d as ie,e as ne,h as ae,i as se,j as me,k as de,l as pe,m as ce,n as le,o as ue,p as fe,q as be,s as he,t as ge,u as Oe}from"./chunk-D64KMOW7.js";import{A as h,Ac as re,Ib as d,Jb as P,Kb as q,Lb as Q,M as g,Sb as W,Tb as X,Ua as a,X as N,Ya as O,a as R,b as V,ba as L,cb as c,fb as z,gb as l,ia as U,ja as J,ka as E,m as H,nb as s,oc as v,pc as Y,rc as Z,sb as i,sc as f,tb as n,ub as u,vb as K,xb as T,yb as _,zc as ee}from"./chunk-OPJ6Y5BO.js";function Ee(t,r){if(t&1&&(i(0,"div"),d(1),n()),t&2){let e=r.$implicit;a(),Q(" ",e.quantity,"x ",e.name," - S/ ",e.price," ")}}function Te(t,r){if(t&1&&(i(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title"),d(3),n(),i(4,"mat-card-subtitle"),d(5),W(6,"date"),n()(),i(7,"mat-card-content"),l(8,Ee,2,3,"div",2),i(9,"strong"),d(10),n()()()),t&2){let e=_();a(3),q("Mesa: ",e.order.tableNumber,""),a(2),P(X(6,4,e.order.createdAt,"short")),a(3),s("ngForOf",e.order.items),a(2),q("Total: S/ ",e.order.total,"")}}var D=class t{order;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-order"]],inputs:{order:"order"},decls:1,vars:1,consts:[["class","order-card",4,"ngIf"],[1,"order-card"],[4,"ngFor","ngForOf"]],template:function(e,o){e&1&&l(0,Te,11,7,"mat-card",0),e&2&&s("ngIf",o.order)},dependencies:[f,v,Y,Z,ve,xe,_e,ye,Fe,Ce],styles:[".order-card[_ngcontent-%COMP%]{width:250px;margin:16px}"]})};function Pe(t,r){if(t&1&&u(0,"app-order",2),t&2){let e=r.$implicit;s("order",e)}}var w=class t{orders=[];trackById(r,e){return e.id}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-order-list"]],inputs:{orders:"orders"},decls:2,vars:2,consts:[[1,"order-list"],[3,"order",4,"ngFor","ngForOf","ngForTrackBy"],[3,"order"]],template:function(e,o){e&1&&(i(0,"div",0),l(1,Pe,1,1,"app-order",1),n()),e&2&&(a(),s("ngForOf",o.orders)("ngForTrackBy",o.trackById))},dependencies:[D,v,f],styles:[".order-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px}"]})};var y=class{id;tableNumber;items;total;createdAt;constructor(r){Object.assign(this,r)}};var A=class{name;quantity;price;constructor(r){Object.assign(this,r)}};var k=class{static toEntityFromResource(r){return new y({id:r.id,tableNumber:r.tableNumber,total:r.total,createdAt:r.createdAt,items:r.items.map(o=>new A({name:o.name,quantity:o.quantity,price:o.price}))})}static toResourceFromEntity(r){return{id:r.id,tableNumber:r.tableNumber,createdAt:r.createdAt,total:r.total,items:r.items?.map(e=>({name:e.name,quantity:e.quantity,price:e.price}))||[]}}};var B=class{isInvalidControl(r,e){return r.controls[e].invalid&&r.controls[e].touched}errorMessageForControl(r,e){switch(e){case"required":return`The field ${r} is required.`;default:return`The field ${r} is invalid.`}}errorMessagesForControl(r,e){let o=r.controls[e],m="",p=o.errors;return p&&Object.keys(p).forEach(b=>m+=this.errorMessageForControl(e,b)),m}};var F=class{httpOptions={headers:new ee({"Content-Type":"application/json"})};serverBaseUrl=`${C.serverBaseUrl}`;resourceEndpoint="/resources";http=L(re);handleError(r){return r.error instanceof ErrorEvent?console.error("An error occurred:",r.error.message):console.error(`Backend returned code ${r.status}, body was: ${r.error}`),H(()=>new Error("Something bad happened; please try again later."))}resourcePath(){return`${this.serverBaseUrl}${this.resourceEndpoint}`}create(r){return this.http.post(this.resourcePath(),JSON.stringify(r),this.httpOptions).pipe(g(2),h(this.handleError))}delete(r){return this.http.delete(`${this.resourcePath()}/${r}`,this.httpOptions).pipe(g(2),h(this.handleError))}update(r,e){return this.http.put(`${this.resourcePath()}/${r}`,JSON.stringify(e),this.httpOptions).pipe(g(2),h(this.handleError))}getAll(){return this.http.get(this.resourcePath(),this.httpOptions).pipe(g(2),h(this.handleError))}getById(r){return this.http.get(`${this.resourcePath()}/${r}`,this.httpOptions).pipe(g(2),h(this.handleError))}};var x=class t extends F{resourceEndpoint=C.ordersEndpointPath;static \u0275fac=(()=>{let r;return function(o){return(r||(r=E(t)))(o||t)}})();static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})};var $=class t extends F{resourceEndpoint=C.dishesEndpointPath;static \u0275fac=(()=>{let r;return function(o){return(r||(r=E(t)))(o||t)}})();static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})};function we(t,r){if(t&1&&(i(0,"option",14),d(1),n()),t&2){let e=r.$implicit;s("value",e.name),a(),P(e.name)}}function Ae(t,r){if(t&1){let e=K();i(0,"div",8)(1,"select",9)(2,"option",10),d(3,"Select a dish from menu"),n(),l(4,we,2,2,"option",11),n(),u(5,"input",12),i(6,"button",13),T("click",function(){let m=U(e).index,p=_();return J(p.removeItem(m))}),d(7,"Remove"),n()()}if(t&2){let e=r.index,o=_();s("formGroupName",e),a(4),s("ngForOf",o.dishes)}}var j=class t extends B{constructor(e,o,m){super();this.fb=e;this.orderService=o;this.dishService=m}form;dishes=[];ngOnInit(){this.form=this.fb.group({tableNumber:[null,S.required],items:this.fb.array([])}),this.dishService.getAll().subscribe(e=>this.dishes=e),this.addItem()}get items(){return this.form.get("items")}addItem(){this.items.push(this.fb.group({name:[null,S.required],quantity:[1,[S.required,S.min(1)]]}))}removeItem(e){this.items.removeAt(e)}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}let e=this.form.value,o=e.items.map(b=>{let M=this.dishes.find(Me=>Me.name===b.name);return V(R({},b),{price:M?.price||0})}),m=o.reduce((b,M)=>b+M.quantity*M.price,0),p=new y({tableNumber:e.tableNumber,items:o,total:m,createdAt:new Date().toISOString()});this.orderService.create(p).subscribe(()=>{alert("Successfully saved"),this.form.reset(),this.items.clear(),this.addItem()})}static \u0275fac=function(o){return new(o||t)(O(he),O(x),O($))};static \u0275cmp=c({type:t,selectors:[["app-order-form"]],features:[z],decls:13,vars:2,consts:[[1,"order-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","tableNumber"],["type","number","id","tableNumber","formControlName","tableNumber"],["formArrayName","items",1,"items-group"],["class","item-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"add-btn",3,"click"],["type","submit",1,"submit-btn"],[1,"item-row",3,"formGroupName"],["formControlName","name"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","quantity","min","1"],["type","button",1,"remove-btn",3,"click"],[3,"value"]],template:function(o,m){o&1&&(i(0,"form",0),T("ngSubmit",function(){return m.onSubmit()}),i(1,"h2"),d(2,"Create new Order"),n(),i(3,"div",1)(4,"label",2),d(5,"Table number"),n(),u(6,"input",3),n(),i(7,"div",4),l(8,Ae,8,2,"div",5),n(),i(9,"button",6),T("click",function(){return m.addItem()}),d(10,"Add dish"),n(),i(11,"button",7),d(12,"Save order"),n()()),o&2&&(s("formGroup",m.form),a(8),s("ngForOf",m.items.controls))},dependencies:[f,v,Oe,ae,ue,fe,oe,se,le,ie,ne,be,me,ce,de,pe,ge],styles:[".order-form[_ngcontent-%COMP%]{background-color:#e4f9e4;padding:2rem;border-radius:12px;max-width:600px;margin:2rem auto;box-shadow:0 0 10px #0000001a;font-family:Arial,sans-serif}.order-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#2f5936;margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%], .item-row[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;flex-direction:column}.item-row[_ngcontent-%COMP%]{gap:.5rem;background-color:#fff;padding:1rem;border:1px solid #cceccc;border-radius:8px}input[type=number][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #8fc98f;border-radius:5px;background-color:#f6fff6}button[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem 1rem;border-radius:6px;border:none;cursor:pointer;font-weight:700}.add-btn[_ngcontent-%COMP%]{background-color:#a0e3a0;color:#2f5936}.submit-btn[_ngcontent-%COMP%]{background-color:#5cbf5c;color:#fff;width:100%;margin-top:1rem}.remove-btn[_ngcontent-%COMP%]{background-color:#f66;color:#fff;align-self:flex-start}"]})};var Ie=class t{constructor(r){this.apiService=r;this.apiService.getAll().subscribe(e=>{this.orders=e.map(k.toEntityFromResource)})}orders=[];static \u0275fac=function(e){return new(e||t)(O(x))};static \u0275cmp=c({type:t,selectors:[["app-orders"]],decls:3,vars:1,consts:[[1,"home-container"],[3,"orders"]],template:function(e,o){e&1&&(i(0,"div",0),u(1,"app-order-form"),n(),u(2,"app-order-list",1)),e&2&&(a(2),s("orders",o.orders))},dependencies:[w,f,te,j],encapsulation:2})};export{Ie as OrdersComponent};
